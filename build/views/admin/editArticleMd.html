<!doctype html>
<html lang="zh-cn">

<head>
    <meta charset="utf-8" />
    <title>修改文章</title>
    <link rel="stylesheet" href="/stylesheets/bootstrap.min.css" />
    <link rel="stylesheet" href="/stylesheets/layout.css" type="text/css" media="screen" />
    <link rel="stylesheet" href="/vendors/editor.md-master/css/editormd.css" />
    <link rel="stylesheet" href="/vendors/uploader/webuploader.css" />
</head>

<body>
    <% include header.html %>
    <!-- end of header bar -->
    <!--导入菜单-->
    <% include menu.html %>
    <section id="main" class="column">
        <h4 class="alert_info">修改成功。</h4>
        <div class="clear"></div>
        <article class="module width_full">
            <form action="" method="post" onsubmit="return false">
                <header>
                    <h3>修改博客</h3>
                </header>
                <div class="module_content">
                    <fieldset>
                        <label>标题：</label>
                        <input type="text" name="title" id="title_color" value="<%= blog.title%>" required>
                    </fieldset>
                    <fieldset>
                        <div id="test-editormd">
                            <textarea style="display:none;" name="content"><%- blog.content%></textarea>
                        </div>
                    </fieldset>
                    <fieldset>
                        <!-- to make two field float next to one another, adjust values accordingly -->
                        <label>Category</label>
                        <input class="input-large" type="text" list="catelist" name="category" value="<%= blog.category%>">
                        <datalist id="catelist">
                            <% categories.forEach(function(cate){%>
                            <option><%= cate.cateName%></option>
                            <% })%>
                        </datalist>
                        <label>Tags</label>
                        <input type="text" name="tags" value="<%= blog.tags%>">
                        <input type="hidden" name="ismd" value="1">
                    </fieldset>
                    <div class="clear"></div>
                </div>
                <footer>
                    <div class="submit_link">
                        <select name="status">
                            <option value="1" selected>发布</option>
                            <option value="0">草稿</option>
                        </select>
                        <input type="submit" value="Publish" class="alt_btn">
                    </div>
                </footer>
            </form>
        </article>
        <!-- end of post new article -->
        <div class="spacer"></div>
    </section>
    <script src="http://apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script>
    <script src="/vendors/editor.md-master/editormd.min.js"></script>
    <script type="text/javascript" src="/vendors/uploader/webuploader.min.js"></script>
    <script type="text/javascript" src="/javascripts/bootstrap.min.js"></script>
    <script type="text/javascript">
        var testEditor;
        $(function () {
            mdtestEditor = editormd("test-editormd", {
                width: "100%",
                height: 340,
                syncScrolling: "single",
                path: "/vendors/editor.md-master/lib/"
            });
            mdtestEditor.setToolbarAutoFixed(false);

            /*
            // or
            testEditor = editormd({
                id      : "test-editormd",
                width   : "90%",
                height  : 640,
                path    : "../lib/"
            });
            */
            $(".alt_btn").click(function () {
                var title = $('input[name=title]').val();
                var content = $('textarea[name=content]').val();
                var status = $('select[name=status]').val();
                var category = $('input[name=category]').val();
                var tags = $('input[name=tags]').val();
                var id = "<%= blog.id%>";
                $.post('/admin/updateArticle/' + id, {
                    id: id,
                    title: title,
                    content: content,
                    category: category,
                    tags: tags,
                    status: status,
                    ismd: 1
                }, function (data) {
                    alert("ok")
                    $('.alert_info').css('display', 'block');
                })
            })
        });
    </script>
</body>

</html>